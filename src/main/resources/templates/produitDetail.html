<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>E-Souk</title>

    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <title>E-souk</title>

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css">
    <!-- Bootstrap core CSS -->
    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <!-- Material Design Bootstrap -->
    <link href="../css/mdb.min.css" rel="stylesheet">
    <link href="../css/produitDetail.css" rel="stylesheet">

    <link href="https://fonts.googleapis.com/css2?family=Covered+By+Your+Grace&display=swap" rel="stylesheet">
    <meta name='viewport' content='width=device-width, initial-scale=1'>

    <script src="https://kit.fontawesome.com/a076d05399.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Raleway:wght@600&display=swap" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <link rel="stylesheet" href="https://wagtrung.github.io/store/themify-icons/themify-icons.css">
    <link href="css/addons-pro/steppers.css" rel="stylesheet">
    <!-- Stepper CSS - minified-->
    <link href="css/addons-pro/steppers.min.css" rel="stylesheet">

    <!-- Stepper JavaScript -->
    <script type="text/javascript" src="js/addons-pro/steppers.js"></script>
    <!-- Stepper JavaScript - minified -->
    <script type="text/javascript" src="js/addons-pro/steppers.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@600&family=Oswald:wght@500&family=Overlock:wght@700&display=swap" rel="stylesheet">
    <style>
        p,h1,h2,h3,h4,h5,h6,div,span,td,li,a{
            font-family: 'Nunito', sans-serif;
        }
    </style>




</head>
<body style="background: #f5f5f5;">
<nav class="navbar fixed-top navbar-expand-lg  navbar-light scrolling-navbar white">
    <div class="container">
        <!-- SideNav slide-out button -->
        <div class="float-left mr-2">
            <a href="#" data-activates="slide-out" class="button-collapse">
                <i class="fas fa-bars green-text"></i>
            </a>
        </div>
        <a class="navbar-brand font-weight-bold" href="#">
            <strong>E-Souk</strong>
        </a>

        <div class="collapse navbar-collapse" id="navbarSupportedContent-4">
            <ul class="navbar-nav ml-auto">
                <li class="nav-item">
                    <img th:src="@{'../img/'+ ${client.photo} +'.jpg'}" style="width: 24px;height: 24px;border-radius: 100%;"/>
                </li>
                <li class="nav-item">
                    <a class="nav-link waves-effect waves-light dark-grey-text font-weight-bold" href="#" th:text="${client.nom+' '+client.prenom}">

                    </a>
                </li>
                <li class="nav-item ml-3">
                    <a class="nav-link waves-effect waves-light dark-grey-text font-weight-bold" th:href="@{../userHome/user}">
                        <i class="fas fa-home green-text"></i></a>
                </li>
                <li class="nav-item dropdown ml-3">
                    <a class="nav-link dropdown-toggle waves-effect waves-light dark-grey-text font-weight-bold" id="navbarDropdownMenuLink-4" data-toggle="dropdown"
                       aria-haspopup="true" aria-expanded="false">
                        Profile </a>
                    <div class="dropdown-menu dropdown-menu-right dropdown-cyan" aria-labelledby="navbarDropdownMenuLink-4">
                        <a class="dropdown-item waves-effect waves-light" href="#">Mise a jour du profil</a>
                        <a class="dropdown-item waves-effect waves-light" th:href="@{/logout}">se deconnecter</a>
                    </div>
                </li>
                <li class="nav-item">
                    <a href="#!" class="nav-link waves-effect" data-toggle="modal" data-target="#modalCart">
                        <span class="badge red z-depth-1 mr-1" th:text="${panier.getSize()}"> </span>
                        <i id="navbar-static-cart" alt="Cart" class="fas fa-shopping-cart"></i>
                        <span class="sr-only"> Cart </span></a>
                </li>


            </ul>
        </div>
    </div>
</nav>
<h1 style="margin-top:80px;padding:10px 10px 10px 10px;" class="container">Details sur le produit</h1>
<div class="container  z-depth-1" style="background: white;">
    <section class="text-center">

        <div class="row">

            <div class="col-lg-6">

        <img th:src="@{'../img/'+ ${produitmettre.produit.photo} +'.jpg'}" style="width: 400px;" class="zoom">

            </div>

            <div class="col-lg-5 text-center text-md-left" style="margin-top: 10px;margin-bottom: 10px;">

                <h2 class="h2-responsive text-center text-md-left product-name  dark-grey-text mb-1 ml-xl-0 ml-4"  th:text="${produitmettre.nom}" >

                </h2>
                <span class="badge badge-danger product mb-4 ml-xl-0 ml-4"></span>
                <h3 class="h3-responsive text-center text-md-left mb-5 ml-xl-0 ml-4">
          <span class="red-text font-weight-bold">
            <strong th:text="${produitmettre.prix+' DH'}" class="text-success"></strong>
          </span>
                </h3>
                <h5 style="font-family: 'Poppins', sans-serif;font-weight: bold;" ><strong>Description :</strong></h5>
                <span th:text="${produitmettre.description}" style="font-family: 'Poppins', Arial, sans-serif;margin-left: 10px;" ></span>
                <br>
                <h5 style="font-family: 'Poppins', sans-serif;font-weight: bold;" ><strong>Quantite Restante :</strong></h5>
                <span th:text="${produitmettre.qte+' (en stock)'}" style="font-family: 'Poppins', Arial, sans-serif;margin-left: 10px;" ></span>

                <hr>
                <i class="fas fa-user"></i><span th:text="${' Agriculteur :'+produitmettre.agriculteur.prenom+' '+produitmettre.agriculteur.nom}"></span>
                <br>
                <i class="fas fa-address-book"></i><span th:text="${' Adresse :'+produitmettre.agriculteur.adresse}"></span>
                <div class="divider-small mb-3"></div>
                <div class="row">
                <div class="amber-text fa-sm mb-1 col-lg-3">
                    <i class="fas fa-star" th:each="i: ${#numbers.sequence(1, produitmettre.agriculteur.etoile)}"></i>

                </div>
                 <p th:text="${produitmettre.agriculteur.etoileF+'/5'}" class="col-lg-1" style="margin-bottom: 5px;"></p>
                </div>
                <div class="row">
                <a class="btn btn-success mr-auto col-lg-6" style="justify-content: right;margin-top: 20px;" th:href="@{../userHome/ajouterPanier/{id}(id=${produitmettre.idProduitMettre})}"><i class="fas fa-cart-plus" ></i> Ajouter au panier</a>
                    <button  class="btn btn-orange col-lg-6" data-toggle="modal" data-target="#centralModalSuccess">Evaluer l'agriculteur
                    </button>

                    <!-- Central Modal Medium Success -->
                    <div class="modal fade" id="centralModalSuccess" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
                         aria-hidden="true">
                        <div class="modal-dialog modal-notify modal-success" role="document">
                            <!--Content-->
                            <form class="modal-content" th:action="@{/produitDetail/{id}(id=${produitmettre.idProduitMettre})}"  method="post">
                                <!--Header-->
                                <div class="modal-header">
                                    <p class="heading lead">Evaluation</p>

                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true" class="white-text">&times;</span>
                                    </button>
                                </div>

                                <!--Body-->
                                <div class="modal-body">
                                    <div class="text-center">
                                        <div class='rating-stars text-center'>
                                            <ul id='stars'>
                                                <li class='star' title='Poor' data-value='1'>
                                                    <i class='fa fa-star fa-fw'></i>
                                                </li>
                                                <li class='star' title='Fair' data-value='2'>
                                                    <i class='fa fa-star fa-fw'></i>
                                                </li>
                                                <li class='star' title='Good' data-value='3'>
                                                    <i class='fa fa-star fa-fw'></i>
                                                </li>
                                                <li class='star' title='Excellent' data-value='4'>
                                                    <i class='fa fa-star fa-fw'></i>
                                                </li>
                                                <li class='star' title='WOW!!!' data-value='5'>
                                                    <i class='fa fa-star fa-fw'></i>
                                                </li>
                                            </ul>
                                        </div>


                                    </div>
                                </div>

                                <!--Footer-->
                                <div class="modal-footer justify-content-center">

                                    <div class='success-box'>
                                        <div class='clearfix'></div>
                                        <img alt='tick image' width='32' src='data:image/svg+xml;utf8;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/Pgo8IS0tIEdlbmVyYXRvcjogQWRvYmUgSWxsdXN0cmF0b3IgMTkuMC4wLCBTVkcgRXhwb3J0IFBsdWctSW4gLiBTVkcgVmVyc2lvbjogNi4wMCBCdWlsZCAwKSAgLS0+CjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiBpZD0iTGF5ZXJfMSIgeD0iMHB4IiB5PSIwcHgiIHZpZXdCb3g9IjAgMCA0MjYuNjY3IDQyNi42NjciIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDQyNi42NjcgNDI2LjY2NzsiIHhtbDpzcGFjZT0icHJlc2VydmUiIHdpZHRoPSI1MTJweCIgaGVpZ2h0PSI1MTJweCI+CjxwYXRoIHN0eWxlPSJmaWxsOiM2QUMyNTk7IiBkPSJNMjEzLjMzMywwQzk1LjUxOCwwLDAsOTUuNTE0LDAsMjEzLjMzM3M5NS41MTgsMjEzLjMzMywyMTMuMzMzLDIxMy4zMzMgIGMxMTcuODI4LDAsMjEzLjMzMy05NS41MTQsMjEzLjMzMy0yMTMuMzMzUzMzMS4xNTcsMCwyMTMuMzMzLDB6IE0xNzQuMTk5LDMyMi45MThsLTkzLjkzNS05My45MzFsMzEuMzA5LTMxLjMwOWw2Mi42MjYsNjIuNjIyICBsMTQwLjg5NC0xNDAuODk4bDMxLjMwOSwzMS4zMDlMMTc0LjE5OSwzMjIuOTE4eiIvPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8L3N2Zz4K'/>
                                        <div class='text-message'></div>
                                        <div class='clearfix'></div>
                                    </div>
                                    <input type="hidden" name="etoileF" value="" id="etoileF">
                                    <button type="submit" class="btn btn-success">Terminer l'evaluation</button>
                                </div>
                            </form>
                            <!--/.Content-->
                        </div>
                    </div>

                </div>
            </div>

        </div>

    </section>
    <!--Section: Content-->


</div>
<div class="container" style="margin-top: 15px;">
    <h1>Suggestion</h1>
    <div class="row">
    <div class="cardProduit " th:each="produit:${produitMettre}" id="cardProduit"  style="margin-bottom: 200px;">

        <div class="card-wrapper"  id="card" >
            <div  id="card-1" class="card card-rotating text-center">
                <div class="face front">
                    <div class="card-up">
                        <img class="card-img-top" th:src="@{'/img/'+ ${produit.produit.photo} +'.jpg'}"  alt="produit">
                    </div>
                    <hr>
                </div>

                <div class="card-body card-body-cascade">
                    <h3 class="card-title" th:text="${produit.produit.designation}" style="font-family:'Covered By Your Grace';font-size: 16px;" id="textProduits"></h3>


                    <h3 class="card-text"  style="font-size:12px;" th:text="${produit.description}"></h3>


                    <div class="card-footer px-1" id="card-footer">
                        <strong><span class="float-left text-success" th:text="${produit.prix}+' DH'" style="font-size:14px;"></span></strong>
                        <span class="float-right">
											<a class="material-tooltip-main text-success" data-toggle="tooltip" data-placement="top" title="" data-original-title="Voir" th:href="@{../produitDetail/{id}(id=${produit.idProduitMettre})}">
											  <i class="fas fa-eye ml-3 green-text"></i>
											</a>
											<a class="material-tooltip-main text-succes" data-toggle="tooltip" data-placement="top" title="" data-original-title="Add to Wishlist" th:href="@{ajouterPanier/{id}(id=${produit.idProduitMettre})}">
											  <i class="fas fa-shopping-cart ml-3 green-text"></i>
											</a>
										<img class="img-fluid" data-toggle="tooltip" data-placement="top" title="" data-original-title="Agriculteur" th:src="@{'/img/'+ ${produit.agriculteur.photo} +'.jpg'}" style="width: 20px; border-radius: 100%; margin-left: 8px;"/>

										  </span>


                    </div>
                </div>

            </div>
        </div>
    </div>
    </div>

</div>
<div class="container my-5 py-5 z-depth-1">

    <!--Section: Content-->
    <section class="px-md-5 mx-md-5 text-center text-lg-left dark-grey-text">


        <!--Grid row-->
        <div class="row d-flex justify-content-center">

            <!--Grid column-->
            <div class="col-md-6 text-center">

                <h4 class="font-weight-bold mb-4">Commenter</h4>

                <form class="input-group mb-4" method="post" th:action="@{/commenter/{id}(id=${produitmettre.id})}" th:object="${commentair}">
                    <input type="text" class="form-control" placeholder="Enter your email address" aria-label="Commenter..." th:field="*{commentaire}"
                           aria-describedby="button-addon2">
                    <div class="input-group-append">
                        <input class="btn btn-md btn-outline-default m-0 px-3 py-2 z-depth-0 waves-effect" type="submit"
                                id="button-addon2" value="commenter">
                    </div>
                </form>

            </div>
            <!--Grid column-->
        </div>
        <!--Grid row-->


    </section>
    <!--Section: Content-->


</div>
<div class="container my-5">


    <!--Section: Block Content-->
    <section class="dark-grey-text mb-5">

        <!-- Section heading -->
        <h1 class="font-weight-bold text-center mb-5">Les commentaires</h1>
        <h3 th:text="${commentaires.size()==0?'Aucun commentaire':''}" style="text-align: center;"></h3>
        <div class="media mb-3" th:each="commentaire:${commentaires}" th:if="${commentaires!=null}">
            <img class="card-img-100 rounded-circle z-depth-1-half d-flex mr-3"  th:src="@{'/img/'+ ${commentaire.client.photo} +'.jpg'}" alt="Generic placeholder image">
            <div class="media-body">
                <a>
                    <h5 class="user-name font-weight-bold" th:text="${commentaire.client.prenom}+' '+${commentaire.client.nom}"></h5>
                </a>
                <!-- Rating -->

                <div class="card-data">
                    <ul class="list-unstyled mb-1">
                        <li class="comment-date font-small grey-text">
                            <i class="far fa-clock"></i><span th:text="${commentaire.dateDeCreation}"></span></li>
                    </ul>
                </div>
                <p class="dark-grey-text article" th:text="${commentaire.commentaire}"></p>
            </div>
        </div>


    </section>
    <!--Section: Block Content-->


</div>
<script>
    $(document).ready(function(){

        /* 1. Visualizing things on Hover - See next part for action on click */
        $('#stars li').on('mouseover', function(){
            var onStar = parseInt($(this).data('value'), 10); // The star currently mouse on

            // Now highlight all the stars that's not after the current hovered star
            $(this).parent().children('li.star').each(function(e){
                if (e < onStar) {
                    $(this).addClass('hover');
                }
                else {
                    $(this).removeClass('hover');
                }
            });

        }).on('mouseout', function(){
            $(this).parent().children('li.star').each(function(e){
                $(this).removeClass('hover');
            });
        });


        /* 2. Action to perform on click */
        $('#stars li').on('click', function(){
            var onStar = parseInt($(this).data('value'), 10); // The star currently selected
            var stars = $(this).parent().children('li.star');

            for (i = 0; i < stars.length; i++) {
                $(stars[i]).removeClass('selected');
            }

            for (i = 0; i < onStar; i++) {
                $(stars[i]).addClass('selected');
            }

            // JUST RESPONSE (Not needed)
            var ratingValue = parseInt($('#stars li.selected').last().data('value'), 10);
            var msg = "";
            if (ratingValue > 1) {
                msg = "Merci ! vous avez evaluez  " + ratingValue + " etoiles.";
            }
            else {
                msg = "We will improve ourselves. You rated this " + ratingValue + " stars.";
            }
            responseMessage(msg);
            document.getElementById("etoileF").value = ratingValue;

        });


    });


    function responseMessage(msg) {
        $('.success-box').fadeIn(200);
        $('.success-box div.text-message').html("<span>" + msg + "</span>");
    }
</script>
<script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
<script type="application/javascript" src="../js/jquery-3.4.1.min.js" ></script>
<script type="application/javascript" src="../js/home.js" ></script>
</body>
</html>
